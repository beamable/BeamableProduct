using Beamable.Api.Autogenerated.Models;

namespace cli.Unreal;

public struct UnrealFederationDeclaration
{
	public string OwnerMicroserviceName;
	public string FederationType;
	public string FederationId;

	private string _sanitizedFederationId;
	private string _sanitizedFederationType;

	public string SanitizedFederationId => _sanitizedFederationId;
	public string SanitizedFederationType => _sanitizedFederationType;
	
	public void IntoProcessMap(Dictionary<string, string> helperDict)
	{
		helperDict.Add(nameof(UnrealSourceGenerator.blueprintExportMacro), UnrealSourceGenerator.blueprintExportMacro);
		
		helperDict.Add(nameof(OwnerMicroserviceName), OwnerMicroserviceName);
		helperDict.Add(nameof(FederationType), FederationType);
		helperDict.Add(nameof(FederationId), FederationId);

		_sanitizedFederationType = FederationType.SpaceOutOnUpperCase();
		_sanitizedFederationId = FederationId.Sanitize().Capitalize();
		helperDict.Add(nameof(_sanitizedFederationType), FederationType.SpaceOutOnUpperCase());
		helperDict.Add(nameof(_sanitizedFederationId), FederationId.Sanitize().Capitalize());
	}


	public const string FEDERATION_GETTERS_DEFINITION = $@"
	UFUNCTION(BlueprintGetter, BlueprintInternalUseOnly, Category=""Beam|₢{nameof(OwnerMicroserviceName)}₢|Utils|Federation"")
	FString Get₢{nameof(FederationType)}₢_Id_₢{nameof(_sanitizedFederationId)}₢() const {{ return TEXT(""₢{nameof(FederationId)}₢""); }}

	UFUNCTION(BlueprintCallable, BlueprintInternalUseOnly, Category=""Beam|₢{nameof(OwnerMicroserviceName)}₢|Utils|Federation"")
	void Get₢{nameof(FederationType)}₢_Data_₢{nameof(_sanitizedFederationId)}₢(UPARAM(DisplayName=""MicroserviceName"") FString& MsName, UPARAM(DisplayName=""FederationId"") FString& Id)
	{{
		MsName = GetMicroserviceName();
		Id = Get₢{nameof(FederationType)}₢_Id_₢{nameof(_sanitizedFederationId)}₢();
	}}";


	public const string FEDERATION_BP_NODE_HEADER = $@"
#pragma once

#include ""CoreMinimal.h""
#include ""AutoGen/SubSystems/Beam₢{nameof(OwnerMicroserviceName)}₢Api.h""
#include ""BeamFlow/K2BeamNode_GetLocalState.h""

#include ""K2BeamNode_Federations_₢{nameof(OwnerMicroserviceName)}₢_₢{nameof(FederationType)}₢_₢{nameof(_sanitizedFederationId)}₢.generated.h""

#define LOCTEXT_NAMESPACE ""UK2BeamNode_₢{nameof(OwnerMicroserviceName)}₢_₢{nameof(FederationType)}₢_₢{nameof(_sanitizedFederationId)}₢""

/**
* This is the code-gen'ed declaration for the federation: ₢{nameof(_sanitizedFederationType)}₢ - ₢{nameof(_sanitizedFederationId)}₢ (₢{nameof(FederationId)}₢). 
*/
UCLASS(meta=(BeamGetLocalState))
class ₢{nameof(UnrealSourceGenerator.blueprintExportMacro)}₢ UK2BeamNode_₢{nameof(OwnerMicroserviceName)}₢_₢{nameof(FederationType)}₢Data_₢{nameof(_sanitizedFederationId)}₢ : public UK2BeamNode_GetLocalState
{{
	GENERATED_BODY()

	virtual FText GetNodeTitle(ENodeTitleType::Type TitleType) const override {{ return LOCTEXT(""Title"", ""Local State - ₢{nameof(OwnerMicroserviceName)}₢ - ₢{nameof(_sanitizedFederationType)}₢ Data - ₢{nameof(_sanitizedFederationId)}₢""); }}

	virtual FName GetSubsystemSelfFunctionName() const override {{ return GET_FUNCTION_NAME_CHECKED(UBeam₢{nameof(OwnerMicroserviceName)}₢Api, GetSelf); }}

	virtual FName GetFunctionName() const override {{ return GET_FUNCTION_NAME_CHECKED(UBeam₢{nameof(OwnerMicroserviceName)}₢Api, Get₢{nameof(FederationType)}₢_Data_₢{nameof(_sanitizedFederationId)}₢); }}

	virtual UClass* GetRuntimeSubsystemClass() const override {{ return UBeam₢{nameof(OwnerMicroserviceName)}₢Api::StaticClass(); }}
}};

#undef LOCTEXT_NAMESPACE";
}
