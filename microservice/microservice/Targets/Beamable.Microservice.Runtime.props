<Project>
    <PropertyGroup>
        <ImplicitUsings>disable</ImplicitUsings>
        <Nullable>disable</Nullable>
        <DockerDefaultTargetOS>Linux</DockerDefaultTargetOS>
        <RollForward>LatestMajor</RollForward>
        
        <!-- Warning 1591 is about missing XML comments on methods. Beamable suggests disabling this warning. 
             https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/compiler-messages/cs1591 -->
        <NoWarn>1591</NoWarn>

        <!-- The autogenerated OpenAPI page will use the generated serviceDocs.xml file to handle 
             API descriptions. The OpenAPI page will break if there is no `serviceDocs.xml` file. -->
        <GenerateDocumentationFile>true</GenerateDocumentationFile>

        <!-- The Source Generator we add to the project needs this for the IDE to see its generated files. -->
        <EmitCompilerGeneratedFiles>true</EmitCompilerGeneratedFiles>
    </PropertyGroup>


    <!--  Settings for Beamable Build  -->
    <PropertyGroup>
        <!-- Override the publishable property during beam builds when BeamPublish is included. -->
        <IsPublishable Condition="'$(BeamPublish)' == 'true'">true</IsPublishable>
        
        <!-- The tool path for the beamCLI. -->
        <BeamableTool Condition="'$(BeamableTool)' == ''">$(BEAM_PATH)</BeamableTool>
        <BeamableTool Condition="'$(BeamableTool)' == ''">beam</BeamableTool>

        <!-- The path to the dotnet to be used. -->
        <BeamableDotnetPath Condition="'$(BeamableDotnetPath)' == ''">$(BEAM_DOTNET_PATH)</BeamableDotnetPath>
        <BeamableDotnetPath Condition="'$(BeamableDotnetPath)' == ''">dotnet</BeamableDotnetPath>

        <GenerateClientCode Condition="'$(GenerateClientCode)' == ''">false</GenerateClientCode>
    </PropertyGroup>

    <!-- Set some default Beamable options, https://docs.beamable.com/docs/cli-guide-microservice-configuration -->
    <PropertyGroup>
        <!-- By default, if the BeamId hasn't been set, we use the name of the file -->
        <BeamId Condition="'$(BeamId)'==''">$(MSBuildProjectName)</BeamId>
    </PropertyGroup>
    
    <PropertyGroup Label="Resolve .beamable paths">
        <BeamableProjectRoot Condition="'$(BeamableProjectRoot)'==''">$([MSBuild]::GetDirectoryNameOfFileAbove("$(MSBuildProjectDirectory)/..", ".beamable/connection-configuration.json"))</BeamableProjectRoot>
        <BeamableFolderPath Condition="'$(BeamableFolderPath)'==''">$(BeamableProjectRoot)/.beamable</BeamableFolderPath>
        <BeamableLocalDevProjectPath Condition="'$(BeamableLocalDevProjectPath)'==''">$(BeamableFolderPath)/temp/localDev</BeamableLocalDevProjectPath>
        <BeamableLocalDevProjectsGlob Condition="'$(BeamableLocalDevProjectsGlob)'==''">$(BeamableLocalDevProjectPath)/*.csproj</BeamableLocalDevProjectsGlob>
    </PropertyGroup>
    
    <!-- Make sure that the built dlls and their dependencies are in the output directory -->
    <PropertyGroup>
        <ProduceReferenceAssemblyInOutDir>true</ProduceReferenceAssemblyInOutDir>
        <CopyLocalLockFileAssemblies>true</CopyLocalLockFileAssemblies>
        <PublishDocumentationFile>true</PublishDocumentationFile>
    </PropertyGroup>
    

    <ItemDefinitionGroup>
        <BeamableSetting>
            <Visible>false</Visible>
        </BeamableSetting>
    </ItemDefinitionGroup>

    <ItemGroup>
        <AdditionalFiles Include="federations.json" />
    </ItemGroup>

    <ItemGroup>
        <CompilerVisibleProperty Include="BeamValidateCallableTypesExistInSharedLibraries" />
    </ItemGroup>
    
</Project>