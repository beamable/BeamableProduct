<Project>
    <PropertyGroup>
        <ImplicitUsings>disable</ImplicitUsings>
        <Nullable>disable</Nullable>
        <DockerDefaultTargetOS>Linux</DockerDefaultTargetOS>
        <RollForward>LatestMajor</RollForward>
        
        <!-- Warning 1591 is about missing XML comments on methods. Beamable suggests disabling this warning. 
             https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/compiler-messages/cs1591 -->
        <NoWarn>1591</NoWarn>

        <!-- The autogenerated OpenAPI page will use the generated serviceDocs.xml file to handle 
             API descriptions. The OpenAPI page will break if there is no `serviceDocs.xml` file. -->
        <GenerateDocumentationFile>true</GenerateDocumentationFile>

        <!-- The Source Generator we add to the project needs this for the IDE to see its generated files. -->
        <EmitCompilerGeneratedFiles>true</EmitCompilerGeneratedFiles>
    </PropertyGroup>


    <!--  Settings for Beamable Build  -->
    <PropertyGroup>
        <!-- Override the publishable property during beam builds when BeamPublish is included. -->
        <IsPublishable Condition="'$(BeamPublish)' == 'true'">true</IsPublishable>
        
        <!-- The tool path for the beamCLI. -->
        <BeamableTool Condition="'$(BeamableTool)' == ''">$(BEAM_PATH)</BeamableTool>
        <BeamableTool Condition="'$(BeamableTool)' == ''">beam</BeamableTool>

        <!-- The path to the dotnet to be used. -->
        <BeamableDotnetPath Condition="'$(BeamableDotnetPath)' == ''">$(BEAM_DOTNET_PATH)</BeamableDotnetPath>
        <BeamableDotnetPath Condition="'$(BeamableDotnetPath)' == ''">dotnet</BeamableDotnetPath>

        <GenerateClientCode Condition="'$(GenerateClientCode)' == ''">false</GenerateClientCode>

        <!-- The proper value for BeamCollectorVersion will be injected below this line for non dev builds -->

    </PropertyGroup>

    <!-- Set some default Beamable options, https://help.beamable.com/CLI-Latest/cli/guides/ms-configuration/ -->
    <PropertyGroup>
        <!-- By default, if the BeamId hasn't been set, we use the name of the file -->
        <BeamId Condition="'$(BeamId)'==''">$(MSBuildProjectName)</BeamId>
        <BeamLogProvider Condition="'$(BeamLogProvider)'==''">Clickhouse</BeamLogProvider>
    </PropertyGroup>
    
    <PropertyGroup Label="Resolve .beamable paths">
        <BeamableProjectRoot Condition="'$(BeamableProjectRoot)'==''">$([MSBuild]::GetDirectoryNameOfFileAbove("$(MSBuildProjectDirectory)/..", ".beamable/connection-configuration.json"))</BeamableProjectRoot>
        <BeamableFolderPath Condition="'$(BeamableFolderPath)'==''">$(BeamableProjectRoot)/.beamable</BeamableFolderPath>
        <BeamableLocalDevProjectPath Condition="'$(BeamableLocalDevProjectPath)'==''">$(BeamableFolderPath)/temp/localDev</BeamableLocalDevProjectPath>
        <BeamableLocalDevProjectsGlob Condition="'$(BeamableLocalDevProjectsGlob)'==''">$(BeamableLocalDevProjectPath)/*.csproj</BeamableLocalDevProjectsGlob>
    </PropertyGroup>
    
    <!-- Make sure that the built dlls and their dependencies are in the output directory -->
    <PropertyGroup>
        <ProduceReferenceAssemblyInOutDir>true</ProduceReferenceAssemblyInOutDir>
        <CopyLocalLockFileAssemblies>true</CopyLocalLockFileAssemblies>
        <PublishDocumentationFile>true</PublishDocumentationFile>
    </PropertyGroup>
    

    <ItemDefinitionGroup>
        <BeamableSetting>
            <Visible>false</Visible>
        </BeamableSetting>
    </ItemDefinitionGroup>
    
    <ItemGroup>
        <CompilerVisibleProperty Include="BeamValidateCallableTypesExistInSharedLibraries" />
        <CompilerVisibleProperty Include="EnableUnrealBlueprintCompatibility" />
        <CompilerVisibleProperty Include="BeamId" />
    </ItemGroup>

    <PropertyGroup>
        
        <BeamPackagedVersion>@BUILD_VERSION@</BeamPackagedVersion>
        
        <BeamCollectorBaseUrl>
            
        </BeamCollectorBaseUrl>
    </PropertyGroup>
    
<!--    <ItemGroup>-->
<!--        <BeamBaseDownloadUrl Include="https://collectors.beamable.com/version/BEAM_VERSION/BEAM_FILE_NAME" />-->
<!--        <BeamDebugBaseDownloadUrl Include="$(MSBuildThisFileDirectory)../../Resources/BEAM_FILE_NAME" />-->
<!--    </ItemGroup>-->

    <PropertyGroup>

        <BeamIsWindows>$([MSBuild]::IsOSPlatform('Windows'))</BeamIsWindows>
        <BeamIsLinux>$([MSBuild]::IsOSPlatform('Linux'))</BeamIsLinux>
        <BeamIsMacOS>$([MSBuild]::IsOSPlatform('OSX'))</BeamIsMacOS>
        <BeamRunningArchitecture Condition="'$(BeamRunningArchitecture)'==''">$([System.Runtime.InteropServices.RuntimeInformation]::OSArchitecture.ToString())</BeamRunningArchitecture>

        <BeamPlatform Condition="'$(BeamPlatform)'=='' AND '$(BeamIsWindows)'=='true'" >win</BeamPlatform>
        <BeamPlatform Condition="'$(BeamPlatform)'=='' AND '$(BeamIsLinux)'=='true'" >lin</BeamPlatform>
        <BeamPlatform Condition="'$(BeamPlatform)'=='' AND '$(BeamIsMacOS)'=='true'" >osx</BeamPlatform>
        
        <BeamCollectorConfigFileName>clickhouse-config.yaml</BeamCollectorConfigFileName>
        <BeamCollectorFileName Condition="'$(BeamPlatform)'=='win' AND '$(BeamRunningArchitecture)'=='X64'">collector-windows-amd64.exe</BeamCollectorFileName>
        <BeamCollectorFileName Condition="'$(BeamPlatform)'=='win' AND '$(BeamRunningArchitecture)'=='Arm64'">collector-windows-arm64.exe</BeamCollectorFileName>
        <BeamCollectorFileName Condition="'$(BeamPlatform)'=='lin' AND '$(BeamRunningArchitecture)'=='X64'">collector-linux-amd64</BeamCollectorFileName>
        <BeamCollectorFileName Condition="'$(BeamPlatform)'=='lin' AND '$(BeamRunningArchitecture)'=='Arm64'">collector-linux-arm64</BeamCollectorFileName>
        <BeamCollectorFileName Condition="'$(BeamPlatform)'=='osx' AND '$(BeamRunningArchitecture)'=='X64'">collector-darwin-amd64</BeamCollectorFileName>
        <BeamCollectorFileName Condition="'$(BeamPlatform)'=='osx' AND '$(BeamRunningArchitecture)'=='Arm64'">collector-darwin-arm64</BeamCollectorFileName>

<!--        <BeamCollectorUrl>@(BeamBaseDownloadUrl->Replace('BEAM_FILE_NAME', '$(BeamCollectorFileName)'))</BeamCollectorUrl>-->
<!--        <BeamCollectorConfigUrl>@(BeamBaseDownloadUrl->Replace('BEAM_FILE_NAME', '$(BeamCollectorConfigFileName)'))</BeamCollectorConfigUrl>-->

<!--        <BeamDebugCollectorUrl>@(BeamDebugBaseDownloadUrl->Replace('BEAM_FILE_NAME', '$(BeamCollectorFileName)'))</BeamDebugCollectorUrl>-->
<!--        <BeamDebugCollectorConfigUrl>@(BeamDebugBaseDownloadUrl->Replace('BEAM_FILE_NAME', '$(BeamCollectorConfigFileName)'))</BeamDebugCollectorConfigUrl>-->
    </PropertyGroup>


</Project>
